# Hot Beam Website - Agent Rules

## Scope
- Next.js 16 app in `src/`
- Contact worker in `worker/`
- Instagram refresh worker in `worker-ig-refresh/`

## Architecture
- Public pages read data through `src/lib/public-site-data.ts`.
- Firestore data must be schema-validated via `src/lib/schemas.ts` before write/read usage.
- `src/data/data.json` is the fallback source of truth for missing/invalid Firestore data.
- Admin UI lives under `src/app/admin` and `src/components/admin`.

## Security Requirements
- Never hardcode secrets; use environment variables.
- Keep upload auth and admin checks domain-restricted (`ADMIN_EMAIL_DOMAIN` / `NEXT_PUBLIC_ADMIN_EMAIL_DOMAIN`).
- Do not weaken CORS, token checks, or Turnstile verification in workers.
- Keep Firestore write paths protected by auth checks and validated payloads.

## Coding Style
- Prioritize readability and maintainability over clever abstractions.
- Prefer small, explicit helper functions when logic repeats.
- Avoid dead code, stale comments, and generated artifacts in git.
- Add comments only for non-obvious decisions.

## Validation
Run before finalizing changes:
1. `npm run lint`
2. `npm run build`
3. If worker changed: `npm --prefix worker run deploy -- --dry-run`
4. If IG worker changed: `npm --prefix worker-ig-refresh run deploy -- --dry-run`

rules_version='2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Helper: check if the user is a Hot Beam admin
    function isAdmin() {
      return request.auth != null
        && request.auth.token.email.matches('.*@hotbeamproductions[.]com$');
    }

    // Site singleton documents (home, about, contact, brand, etc.)
    match /site/{docId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // Portfolio projects
    match /projects/{projectId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // Rental items
    match /rentals/{rentalId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // Deny everything else by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
